
// Response wrapper
var resSuccess = module.exports.resSuccess = function (req, res, data) {
	res.status(200)
	res.send({
		isExtensionResponse : true,
		data                : data
	})
}

module.exports.resError = function(req, res, error, statusCode){
	// construct the error message
	module.exports.resSuccess = resSuccess.bind(this)
	res.status(statusCode || 422).send({
		isExtensionError : true,
		errors           : nestedFormatChange(null, error, [])
	})
}

function nestedFormatChange(parentPath, error, actualError){
	Object.keys(error)
	.forEach(function(errorKey){
		if(typeof error[errorKey] === "object" && !(error[errorKey] instanceof Array)){
				return nestedFormatChange(errorKey, error[errorKey], actualError)
		}
		if(!parentPath){
			actualError.push({
				errorKey : error[errorKey],
				path     : errorKey
			})
		} else {
			actualError.push({
				errorKey : error[errorKey],
				path     : parentPath + "." + errorKey
			})
		}
	})
	return actualError
}